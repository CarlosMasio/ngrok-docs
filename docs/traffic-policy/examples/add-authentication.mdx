---
title: Authentication Examples
sidebar_label: Add Authentication
---

import { JWTsRateLimiting } from "/traffic-policy/gallery/JWTsRateLimiting";
import { OAuthConditionalAccess } from "/traffic-policy/gallery/OAuthConditionalAccess";
import { OIDCIdentityToken } from "/traffic-policy/gallery/OIDCIdentityToken";

You can use Traffic Policy to add authentication to your endpoints, granting conditional access to traffic trying to reach your services. This page demonstrates a few examples of doing so.

## JWT authentication

The following example adds key-based rate limiting to your endpoints based on your consumers' JWTs. See the [Auth0 guide](/integrations/auth0/jwt-action/) for more information.

<JWTsRateLimiting />

## Conditional access using OAuth variables

This example grants conditional access to a page using the following ngrok [OAuth action result variables](/traffic-policy/actions/oauth):

- `actions.ngrok.oauth.identity.email.endsWith('ngrok.com')`
  - Checks the email address of the authorized user from the provider. In the example, if the email address's domain is `ngrok.com`, the user will be granted access to the page.
- `actions.ngrok.oauth.identity.name`
  - Gets the name of the authorized user from the provider. In this example, the name will be displayed in a welcome message or a rejection message depending on if the user is authenticated.

<OAuthConditionalAccess />

## Sending an OIDC identity token over headers

This example uses the `actions.ngrok.oidc.identity_token` [OIDC action result variable](/traffic-policy/actions/oidc/#action-result-variables) to send the OIDC identity token over headers to the service at the endpoint.

<OIDCIdentityToken />
